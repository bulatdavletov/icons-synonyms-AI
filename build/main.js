var l=Object.defineProperty,j=Object.defineProperties,$=Object.getOwnPropertyDescriptor,H=Object.getOwnPropertyDescriptors,L=Object.getOwnPropertyNames,N=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var h=(e,o,t)=>o in e?l(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,A=(e,o)=>{for(var t in o||(o={}))E.call(o,t)&&h(e,t,o[t]);if(N)for(var t of N(o))V.call(o,t)&&h(e,t,o[t]);return e},S=(e,o)=>j(e,H(o));var c=(e,o)=>()=>(e&&(o=e(e=0)),o);var Y=(e,o)=>{for(var t in o)l(e,t,{get:o[t],enumerable:!0})},K=(e,o,t,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let s of L(o))!E.call(e,s)&&s!==t&&l(e,s,{get:()=>o[s],enumerable:!(r=$(o,s))||r.enumerable});return e};var W=e=>K(l({},"__esModule",{value:!0}),e);function u(e,o){let t=`${C}`;return C+=1,f[t]={handler:o,name:e},function(){delete f[t]}}function I(e,o){let t=!1;for(let r in f)f[r].name===e&&(f[r].handler.apply(null,o),t=!0);if(t===!1)throw new Error(`No event handler with name \`${e}\``)}var f,C,p,_=c(()=>{f={},C=0;p=typeof window=="undefined"?function(e,...o){figma.ui.postMessage([e,...o])}:function(e,...o){window.parent.postMessage({pluginMessage:[e,...o]},"*")};typeof window=="undefined"?figma.ui.onmessage=function(e){if(!Array.isArray(e))return;let[o,...t]=e;typeof o=="string"&&I(o,t)}:window.onmessage=function(e){if(typeof e.data.pluginMessage=="undefined")return;let o=e.data.pluginMessage;if(!Array.isArray(o))return;let[t,...r]=e.data.pluginMessage;typeof t=="string"&&I(t,r)}});function x(e,o){if(typeof __html__=="undefined")throw new Error("No UI defined");let t=`<div id="create-figma-plugin"></div><script>document.body.classList.add('theme-${figma.editorType}');const __FIGMA_COMMAND__='${typeof figma.command=="undefined"?"":figma.command}';const __SHOW_UI_DATA__=${JSON.stringify(typeof o=="undefined"?{}:o)};${__html__}</script>`;figma.showUI(t,S(A({},e),{themeColors:typeof e.themeColors=="undefined"?!0:e.themeColors}))}var T=c(()=>{});var w=c(()=>{_();T()});async function O(e,o={}){try{let t=o.scale||2,s={format:o.format||"PNG",constraint:{type:"SCALE",value:t}},n=await e.exportAsync(s);return figma.base64Encode(n)}catch(t){throw console.error("Error exporting node:",t),new Error("Failed to export icon")}}function y(e){if(e.type==="INSTANCE"){let o=e.mainComponent;if(o)return o}return e}function P(e){if(e.length===0)return null;if(e.length===1)return y(e[0]);let o=e.filter(r=>r.type==="COMPONENT");if(o.length>0)return y(o[0]);let t=e.filter(r=>r.type==="INSTANCE");return t.length>0?y(t[0]):y(e[0])}var v=c(()=>{"use strict"});var b,B=c(()=>{"use strict";b="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"});function R(e,o){return`
    This is an icon named "${e}". 
    ${o?`It currently has this description: "${o}"`:""}
    Please generate relevant synonyms or related terms that would help users find this icon when searching.
    Context: these icons are used in JetBrains IDEs.
    If name contain several words, use them as separate entities: moveToRightTop = move to right top. It increases the chance to find the icon.
    Describe the object from the image: trash bin, folder, heart, etc.
    Describe usual meaning of the object: delete, save, like, etc.
    Describe shapes that you see: circle, square, rectangle, arrow, etc.
    Don't use words like "icon", "symbol", "image", etc.
    Don't repeat the name of icon or existing description.
    Return only a JSON array of strings with no additional text.
  `}var D=c(()=>{"use strict"});async function M(e,o=""){var t;try{let r=o.trim()||z,s="https://api.openai.com/v1/chat/completions",n=R(e.name,e.existingDescription),i={model:"gpt-4o",messages:[{role:"user",content:[{type:"text",text:n},{type:"image_url",image_url:{url:`data:image/png;base64,${e.imageBase64}`}}]}],max_tokens:300};console.log("Sending to OpenAI:",{model:i.model,messages:[{role:"user",content:[{type:"text",text:n},{type:"image_url",image_url:{url:"[BASE64_IMAGE_DATA]"}}]}],max_tokens:i.max_tokens});let m=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(i)}),d=await m.json();if(!m.ok)throw new Error(((t=d.error)==null?void 0:t.message)||"Unknown error from OpenAI API");let a=d.choices[0].message.content;console.log("Response from OpenAI:",a);try{return{synonyms:JSON.parse(a)}}catch(F){let g=a.match(/\[([\s\S]*)\]/);if(g&&g[1])try{return{synonyms:JSON.parse(`[${g[1]}]`)}}catch(J){throw new Error("Failed to parse synonyms from response")}else throw new Error("Response format not recognized")}}catch(r){return console.error("Error generating synonyms:",r),{synonyms:[],error:r.message||"Unknown error occurred"}}}var z,G=c(()=>{"use strict";B();D();z=b});var U={};Y(U,{default:()=>q});function q(){x({width:400,height:500});function e(t,r){t.description=r}function o(){var r,s;let t=figma.currentPage.selection;if(t.length===1){let n=t[0];if(n.type==="COMPONENT"||n.type==="COMPONENT_SET"||n.type==="INSTANCE"){let i=!!(n.type==="INSTANCE"?(r=n.mainComponent)!=null&&r.description:n.description),m=n.type==="INSTANCE"?((s=n.mainComponent)==null?void 0:s.description)||"":n.description||"";p("SELECTION_CHANGE",{name:n.name,type:n.type,description:m,hasDescription:i})}}}u("GENERATE_SYNONYMS",async()=>{try{figma.notify("Generating synonyms...");let t=figma.currentPage.selection,r=P(t);if(!r){p("GENERATE_ERROR",{error:"No valid icon selected"});return}let s=await O(r),n=r.name,i="";r.type==="COMPONENT"?i=r.description||"":r.type==="INSTANCE"&&r.mainComponent&&(i=r.mainComponent.description||"");let m=await M({name:n,imageBase64:s,existingDescription:i}),d=[{title:"Objects",synonyms:m.synonyms.filter(a=>a.startsWith("object:"))},{title:"Actions",synonyms:m.synonyms.filter(a=>a.startsWith("action:"))},{title:"Visual",synonyms:m.synonyms.filter(a=>a.startsWith("visual:"))}];p("SYNONYMS_GENERATED",{groups:d}),figma.notify("Synonyms generated successfully!")}catch(t){console.error("Error in generate-synonyms handler:",t),p("GENERATE_ERROR",{error:t.message||"Unknown error occurred"}),figma.notify("Error generating synonyms")}}),u("UPDATE_DESCRIPTION",t=>{let r=figma.currentPage.selection[0];if(r&&(r.type==="COMPONENT"||r.type==="COMPONENT_SET"))try{r.description=t.synonyms.join(", "),figma.notify("Description updated successfully!")}catch(s){p("GENERATE_ERROR",{error:"Failed to update description: "+s.message})}}),figma.on("selectionchange",()=>{o()}),o()}var k=c(()=>{"use strict";w();v();G()});var X={"src/main.ts--default":(k(),W(U)).default},Q="src/main.ts--default";X[Q]();
